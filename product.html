<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="product-title">益々酒造 - 商品詳細</title>
    <meta name="description" content="益々酒造の日本酒詳細情報。伝統的な醸造法と最高品質の原料で作られた日本酒をご紹介。">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&family=Source+Sans+Pro:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;700&family=Dancing+Script:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .product-detail {
            padding: 120px 0 80px;
            background: var(--gradient-background);
            min-height: 100vh;
        }

        .product-hero {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
            margin-bottom: 80px;
        }

        .product-image-container {
            position: relative;
            text-align: center;
        }

        .product-image {
            max-width: 400px;
            width: 100%;
            height: auto;
            border-radius: 20px;
            box-shadow: var(--shadow-luxury);
            transition: transform 0.3s ease;
        }

        .product-image:hover {
            transform: scale(1.02);
        }

        .product-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--gradient-accent);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .product-info {
            padding: 40px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: var(--shadow-luxury);
            backdrop-filter: blur(10px);
        }

        .product-name {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 16px;
            font-family: var(--font-elegant);
        }

        .product-type {
            font-size: 1.2rem;
            color: var(--color-accent);
            margin-bottom: 24px;
            font-weight: 500;
        }

        .product-price {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 24px;
        }

        .product-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--color-text-secondary);
            margin-bottom: 32px;
        }

        .product-actions {
            display: flex;
            gap: 16px;
            margin-top: 32px;
        }

        .btn-add-cart {
            flex: 1;
            padding: 16px 32px;
            background: var(--gradient-accent);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-add-cart:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-luxury);
        }

        .btn-back {
            padding: 16px 32px;
            background: transparent;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-back:hover {
            background: var(--color-primary);
            color: white;
        }

        .product-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 80px;
        }

        .detail-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 32px;
            border-radius: 20px;
            box-shadow: var(--shadow-luxury);
            backdrop-filter: blur(10px);
        }

        .detail-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .detail-card-icon {
            font-size: 1.8rem;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(26, 22, 17, 0.1);
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: var(--color-primary);
        }

        .detail-value {
            color: var(--color-text-secondary);
            text-align: right;
        }

        .tasting-notes {
            background: var(--gradient-accent);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin: 24px 0;
        }

        .tasting-notes h4 {
            margin-bottom: 12px;
            font-size: 1.2rem;
        }

        .size-options {
            display: flex;
            gap: 16px;
            margin: 24px 0;
        }

        .size-option {
            flex: 1;
            padding: 16px;
            border: 2px solid var(--color-border);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .size-option.selected {
            border-color: var(--color-accent);
            background: rgba(212, 175, 55, 0.1);
        }

        .size-option:hover {
            border-color: var(--color-accent);
        }

        .size-volume {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 4px;
        }

        .size-price {
            color: var(--color-accent);
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .product-hero {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .product-name {
                font-size: 2rem;
            }

            .product-info {
                padding: 24px;
            }

            .product-actions {
                flex-direction: column;
            }

            .detail-card {
                padding: 24px;
            }
        }

        /* AI Chat Widget Styles */
        .ai-chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .ai-chat-toggle {
            background: var(--gradient-accent);
            color: white;
            border: none;
            padding: 16px 20px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow-luxury);
            transition: all 0.3s ease;
        }
        
        .ai-chat-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
        }
        
        .ai-chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 400px;
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-luxury);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .ai-chat-header {
            background: var(--gradient-accent);
            color: white;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ai-chat-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ai-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 280px;
        }
        
        .ai-message, .user-message {
            margin-bottom: 16px;
            padding: 12px;
            border-radius: 12px;
            line-height: 1.5;
        }
        
        .ai-message {
            background: #f3f4f6;
            margin-right: 20px;
        }
        
        .user-message {
            background: var(--color-accent-light);
            margin-left: 20px;
            text-align: right;
        }
        
        .ai-chat-input {
            display: flex;
            padding: 16px;
            border-top: 1px solid #e5e7eb;
            gap: 12px;
        }
        
        .ai-chat-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .ai-chat-input button {
            background: var(--color-accent);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .ai-chat-window {
                width: 300px;
                height: 350px;
            }
            
            .ai-chat-widget {
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <div class="nav-brand">
                    <a href="index.html" class="brand-link">
                        <div class="brand-logo-container">
                            <div class="logo-icon">🍶</div>
                            <div class="brand-text">
                                <h1 class="brand-logo">益々酒造</h1>
                                <span class="brand-tagline">Masumasu Brewery</span>
                            </div>
                        </div>
                    </a>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="nav-menu" id="navMenu">
                    <ul>
                        <li><a href="index.html#products" class="nav-link">日本酒</a></li>
                        <li><a href="index.html#tour" class="nav-link">ツアー</a></li>
                        <li><a href="about.html" class="nav-link">酒蔵について</a></li>
                        <li><a href="visit.html" class="nav-link">蔵見学</a></li>
                        <li><a href="contact.html" class="nav-link">お問い合わせ</a></li>
                    </ul>
                </div>
                
                <div class="nav-right">
                    <div class="google-translate-container">
                    <div id="google_translate_element"></div>
                </div>
                    <button class="cart-btn" id="cartBtn">
                        🛒 <span id="cartCount">0</span>
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Product Detail Section -->
    <section class="product-detail">
        <div class="container">
            <div class="product-hero">
                <div class="product-image-container">
                    <img id="product-image" src="" alt="Product Image" class="product-image">
                    <div id="product-badge" class="product-badge" style="display: none;">限定品</div>
                </div>
                
                <div class="product-info">
                    <h1 id="product-name" class="product-name"></h1>
                    <div id="product-type" class="product-type"></div>
                    <div id="product-price" class="product-price"></div>
                    <div id="product-description" class="product-description"></div>
                    
                    <div id="tasting-notes" class="tasting-notes">
                        <h4>🍶 テイスティングノート</h4>
                        <p id="tasting-notes-text"></p>
                    </div>
                    
                    <div id="size-options" class="size-options"></div>
                    
                    <div class="product-actions">
                        <button id="add-to-cart" class="btn-add-cart">
                            🛒 カートに追加
                        </button>
                        <a href="index.html#products" class="btn-back">
                            ← 商品一覧に戻る
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="product-details-grid">
                <div class="detail-card">
                    <h3><span class="detail-card-icon">🌾</span>原料・製法</h3>
                    <div class="detail-item">
                        <span class="detail-label">使用米</span>
                        <span id="rice-type" class="detail-value"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">精米歩合</span>
                        <span id="rice-polish" class="detail-value"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">酵母</span>
                        <span id="yeast-type" class="detail-value"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">アルコール度数</span>
                        <span id="alcohol-content" class="detail-value"></span>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3><span class="detail-card-icon">🍽️</span>楽しみ方</h3>
                    <div class="detail-item">
                        <span class="detail-label">おすすめ温度</span>
                        <span id="serving-temp" class="detail-value"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">料理との相性</span>
                        <span id="food-pairing" class="detail-value"></span>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3><span class="detail-card-icon">📍</span>酒蔵情報</h3>
                    <div class="detail-item">
                        <span class="detail-label">酒蔵名</span>
                        <span id="brewery-name" class="detail-value">益々酒造</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">所在地</span>
                        <span id="brewery-region" class="detail-value"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">在庫状況</span>
                        <span id="stock-status" class="detail-value"></span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- AI Chat Widget -->
    <div id="ai-chat-widget" class="ai-chat-widget">
        <button id="ai-chat-toggle" class="ai-chat-toggle">
            🤖 AI杜氏に相談
        </button>
        <div id="ai-chat-window" class="ai-chat-window" style="display: none;">
            <div class="ai-chat-header">
                <h4>🍶 AI杜氏 - 益々さん</h4>
                <button id="ai-chat-close" class="ai-chat-close">×</button>
            </div>
            <div id="ai-chat-messages" class="ai-chat-messages">
                <div class="ai-message">
                    <strong>AI杜氏:</strong> こんにちは！この日本酒について何でもお聞きください。醸造のこと、飲み方、料理との相性など、お答えします！
                </div>
            </div>
            <div class="ai-chat-input">
                <input type="text" id="ai-chat-input" placeholder="質問を入力してください...">
                <button id="ai-chat-send">送信</button>
            </div>
        </div>
    </div>

    <script src="js/data.js"></script>
    <script src="js/cart.js"></script>
    <script>
        // Get product ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const productId = parseInt(urlParams.get('id'));
        
        // Find product data
        const product = sakeData.find(p => p.id === productId);
        
        if (!product) {
            window.location.href = 'index.html';
        }
        
        // Get current language
        let currentLanguage = localStorage.getItem('selectedLanguage') || 'ja';
        
        // Populate product information
        function populateProductInfo() {
            document.getElementById('product-title').textContent = `${product.name[currentLanguage]} - 益々酒造`;
            document.getElementById('product-image').src = product.image;
            document.getElementById('product-image').alt = product.name[currentLanguage];
            document.getElementById('product-name').textContent = product.name[currentLanguage];
            document.getElementById('product-type').textContent = product.type[currentLanguage];
            document.getElementById('product-description').textContent = product.description[currentLanguage];
            document.getElementById('tasting-notes-text').textContent = product.tastingNotes[currentLanguage];
            
            // Show limited badge if applicable
            if (product.limited) {
                document.getElementById('product-badge').style.display = 'block';
            }
            
            // Populate details
            document.getElementById('rice-type').textContent = product.riceType[currentLanguage];
            document.getElementById('rice-polish').textContent = product.ricePalish ? `${product.ricePalish}%` : '-';
            document.getElementById('yeast-type').textContent = product.yeast ? product.yeast[currentLanguage] : '-';
            document.getElementById('alcohol-content').textContent = `${product.alcohol}%`;
            document.getElementById('serving-temp').textContent = product.servingTemp[currentLanguage];
            document.getElementById('food-pairing').textContent = product.pairing[currentLanguage];
            document.getElementById('brewery-region').textContent = product.region[currentLanguage];
            document.getElementById('stock-status').textContent = product.inStock > 0 ? `在庫あり (${product.inStock}本)` : '在庫切れ';
            
            // Populate size options
            const sizeOptionsContainer = document.getElementById('size-options');
            sizeOptionsContainer.innerHTML = '';
            
            product.sizes.forEach((size, index) => {
                const sizeOption = document.createElement('div');
                sizeOption.className = `size-option ${index === 0 ? 'selected' : ''}`;
                sizeOption.innerHTML = `
                    <div class="size-volume">${size.size}</div>
                    <div class="size-price">¥${size.price.toLocaleString()}</div>
                `;
                sizeOption.addEventListener('click', () => {
                    document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
                    sizeOption.classList.add('selected');
                    document.getElementById('product-price').textContent = `¥${size.price.toLocaleString()}`;
                });
                sizeOptionsContainer.appendChild(sizeOption);
            });
            
            // Set initial price
            document.getElementById('product-price').textContent = `¥${product.sizes[0].price.toLocaleString()}`;
        }
        
        // Language change handler
        document.getElementById('languageSelect').addEventListener('change', function() {
            currentLanguage = this.value;
            localStorage.setItem('selectedLanguage', currentLanguage);
            populateProductInfo();
        });
        
        // Set language selector
        document.getElementById('languageSelect').value = currentLanguage;
        
        // Add to cart functionality
        document.getElementById('add-to-cart').addEventListener('click', function() {
            const selectedSize = document.querySelector('.size-option.selected');
            const sizeIndex = Array.from(document.querySelectorAll('.size-option')).indexOf(selectedSize);
            
            addToCart(productId, 1, sizeIndex);
            
            // Show feedback
            this.textContent = '✓ カートに追加しました';
            this.style.background = '#22c55e';
            setTimeout(() => {
                this.textContent = '🛒 カートに追加';
                this.style.background = '';
            }, 2000);
        });
        
        // AI Chat functionality
        const chatToggle = document.getElementById('ai-chat-toggle');
        const chatWindow = document.getElementById('ai-chat-window');
        const chatClose = document.getElementById('ai-chat-close');
        const chatInput = document.getElementById('ai-chat-input');
        const chatSend = document.getElementById('ai-chat-send');
        const chatMessages = document.getElementById('ai-chat-messages');
        
        chatToggle.addEventListener('click', () => {
            chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
        });
        
        chatClose.addEventListener('click', () => {
            chatWindow.style.display = 'none';
        });
        
        function addChatMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = isUser ? 'user-message' : 'ai-message';
            messageDiv.innerHTML = `<strong>${isUser ? 'あなた' : 'AI杜氏'}:</strong> ${message}`;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        function generateAIResponse(userMessage) {
            const responses = [
                `${product.name[currentLanguage]}について、${userMessage.includes('飲み方') ? '冷酒でお楽しみいただくのがおすすめです。' : ''}${userMessage.includes('料理') ? product.pairing[currentLanguage] + 'との相性が抜群です。' : ''}${userMessage.includes('味') ? product.tastingNotes[currentLanguage] + 'が特徴的です。' : ''}何か他にご質問はありますか？`,
                `こちらの${product.type[currentLanguage]}は、${product.riceType[currentLanguage]}を使用し、丁寧に醸造しております。${product.alcohol}%のアルコール度数で、${product.description[currentLanguage]}`,
                `${product.name[currentLanguage]}は、${product.labelDescription[currentLanguage]}ぜひお試しください！`,
                `醸造に関するご質問ですね。${product.yeast ? product.yeast[currentLanguage] + 'を使用し、' : ''}伝統的な製法で丁寧に仕込んでおります。何か他にお聞きになりたいことはありますか？`
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            addChatMessage(message, true);
            chatInput.value = '';
            
            // Simulate AI thinking
            setTimeout(() => {
                const response = generateAIResponse(message);
                addChatMessage(response);
            }, 1000);
        }
        
        chatSend.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Initialize page
        populateProductInfo();
        updateCartDisplay();
    </script>

    <!-- Google Translate -->
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'ja',
                includedLanguages: 'en,fr,zh,ko,it,es,vi,ar,de,ru,pt,th,hi,tr,pl,nl,sv,da,no,fi,he,id,ms,tl,bg,hr,cs,et,lv,lt,hu,mt,sk,sl,ro,uk,el,ca,eu,ga,cy,is,fa,ur,bn,ta,te,ml,kn,gu,pa,ne,si,my,km,lo,ka,am,sw,zu,af,sq,az,be,bs,mk,mn,sr,uz,ky,kk,tg,hy,ka',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                gaTrack: true,
                gaId: 'UA-XXXXX-Y'
            }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    
    <!-- Mobile AI Chatbot -->
    <div class="mobile-ai-chatbot">
        <button class="chatbot-btn" onclick="openAIChat()">
            🌸 AIサクラに相談する
        </button>
    </div>
</body>
</html>